<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Cadastro</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Ajustes espec√≠ficos para a p√°gina de cadastro */
        body.cadastro-page .background .shape1 {
            left: auto;
            right: -150px;
            top: -80px;
            animation: floatReverse 6s ease-in-out infinite;
        }

        body.cadastro-page .background .shape2 {
            left: -80px;
            right: auto;
            bottom: -200px;
            animation: float 6s ease-in-out infinite;
        }

        /* Anima√ß√£o de flutua√ß√£o reversa para o shape1 */
        @keyframes floatReverse {
            0%, 100% {
                transform: translateY(0) scale(1);
            }
            50% {
                transform: translateY(20px) scale(1.05);
            }
        }

        /* Transi√ß√£o suave para os shapes (caso haja mudan√ßa) */
        .background .shape {
            transition: all 1s ease-in-out;
        }

        /* Anima√ß√£o de entrada para o formul√°rio */
        body.cadastro-page .container {
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Pequeno ajuste responsivo */
        @media screen and (max-width: 480px) {
            body.cadastro-page .background .shape1 {
                right: -50px;
                top: -50px;
                width: 150px;
                height: 150px;
            }
            
            body.cadastro-page .background .shape2 {
                left: -50px;
                bottom: -50px;
                width: 150px;
                height: 150px;
            }
        }
    </style>
    <!-- Favicon -->
  <link rel="icon" href="https://api.imlabs.com.br/platforms/1/images/favicon/favicon.ico">
</head>
<body class="cadastro-page">
    <!-- Background shapes (agora em posi√ß√µes diferentes) -->
    <div class="background">
        <div class="shape shape1"></div>
        <div class="shape shape2"></div>
    </div>

    <div class="container">
        <form name="form-cadastro">
            <h2 class="form-title">Cadastro</h2>
            
            <input type="hidden" name="action" value="cadastro">

            <!-- Nome Completo -->
            <div class="input-group">
                <span class="input-icon">üë§</span>
                <input type="text" name="nome" placeholder="Nome Completo" required>
            </div>

            <!-- CPF -->
            <div class="input-group">
                <span class="input-icon">üìá</span>
                <input type="text" name="cpf" id="cpf" placeholder="CPF (Opcional)" maxlength="14"
                    oninput="mascaraCPF(this)">
            </div>

            <!-- Email -->
            <div class="input-group">
                <span class="input-icon">üìß</span>
                <input type="email" name="email" placeholder="Email (Opcional)">
            </div>

            <!-- Senha -->
            <div class="password-container input-group">
                <span class="input-icon">üîí</span>
                <input type="password" name="senha" id="senha" placeholder="Crie uma Senha" required>
                <span class="toggle-password" onclick="togglePassword('senha')">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12ZM14 12C14 13.1046 13.1046 14 12 14C10.8954 14 10 13.1046 10 12C10 10.8954 10.8954 10 12 10C13.1046 10 14 10.8954 14 12Z"
                            fill="currentColor" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M12 3C17.5915 3 22.2898 6.82432 23.6219 12C22.2898 17.1757 17.5915 21 12 21C6.40848 21 1.71018 17.1757 0.378052 12C1.71018 6.82432 6.40848 3 12 3ZM12 19C7.52443 19 3.73132 16.0581 2.45723 12C3.73132 7.94186 7.52443 5 12 5C16.4756 5 20.2687 7.94186 21.5428 12C20.2687 16.0581 16.4756 19 12 19Z"
                            fill="currentColor" />
                    </svg>
                </span>
            </div>

            <!-- Confirmar Senha -->
            <div class="password-container input-group">
                <span class="input-icon">üîí</span>
                <input type="password" name="confirma_senha" id="confirma_senha" placeholder="Confirme a Senha" required>
                <span class="toggle-password" onclick="togglePassword('confirma_senha')">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12ZM14 12C14 13.1046 13.1046 14 12 14C10.8954 14 10 13.1046 10 12C10 10.8954 10.8954 10 12 10C13.1046 10 14 10.8954 14 12Z"
                            fill="currentColor" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M12 3C17.5915 3 22.2898 6.82432 23.6219 12C22.2898 17.1757 17.5915 21 12 21C6.40848 21 1.71018 17.1757 0.378052 12C1.71018 6.82432 6.40848 3 12 3ZM12 19C7.52443 19 3.73132 16.0581 2.45723 12C3.73132 7.94186 7.52443 5 12 5C16.4756 5 20.2687 7.94186 21.5428 12C20.2687 16.0581 16.4756 19 12 19Z"
                            fill="currentColor" />
                    </svg>
                </span>
            </div>

            <!-- Bot√£o de cadastro -->
            <button type="submit" class="btn-login" id="bt-cadastrar">
                <span class="btn-text">
                    <span>Cadastrar</span>
                    <span>‚úì</span>
                </span>
            </button>

            <!-- √Årea de mensagens -->
            <div id="message-area" class="offline-box" style="display: none; margin-top: 20px;">
                <div class="offline-icon">üìù</div>
                <p id="message-text"></p>
            </div>

            <!-- Divisor -->
            <div class="divider">
                <span></span>
                <span class="divider-text">ou</span>
                <span></span>
            </div>

            <!-- Link de login -->
            <div class="register-link">
                <p>J√° tem conta? <a href="index.html">Fa√ßa Login</a></p>
            </div>
        </form>
    </div>
    <script>
        // --- Fun√ß√£o da M√°scara de CPF ---
        function mascaraCPF(i) {
            let v = i.value;
            if (isNaN(v[v.length - 1])) { // impede entrar outro caractere que n√£o seja n√∫mero
                i.value = v.substring(0, v.length - 1);
                return;
            }
            i.setAttribute("maxlength", "14");
            v = v.replace(/\D/g, ""); // Remove tudo o que n√£o √© d√≠gito
            v = v.replace(/(\d{3})(\d)/, "$1.$2"); // Coloca ponto entre o 3¬∫ e o 4¬∫ d√≠gitos
            v = v.replace(/(\d{3})(\d)/, "$1.$2"); // Coloca ponto entre o 6¬∫ e o 7¬∫ d√≠gitos
            v = v.replace(/(\d{3})(\d{1,2})$/, "$1-$2"); // Coloca hifem entre o 9¬∫ e o 10¬∫ d√≠gitos
            i.value = v;
        }

        // --- Fun√ß√£o do Olhinho (Mostrar/Ocultar) ---
        function togglePassword(fieldId) {
            const input = document.getElementById(fieldId);
            const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
            input.setAttribute('type', type);
        }

        // --- Envio do Formul√°rio ---
        const formCadastro = document.forms['form-cadastro'];

        formCadastro.addEventListener('submit', function (e) {
            e.preventDefault();

            const senha = document.getElementById('senha').value;
            const confirma = document.getElementById('confirma_senha').value;

            if (senha !== confirma) {
                alert("As senhas n√£o coincidem!");
                return;
            }

            const botao = document.getElementById('bt-cadastrar');
            botao.value = "Salvando...";
            botao.disabled = true;

            fetch(config.script_url, { method: 'POST', body: new FormData(formCadastro) })
                .then(response => response.json())
                .then(data => {
                    if (data.result === 'success') {
                        // AQUI MOSTRAMOS O C√ìDIGO GERADO
                        alert('Cadastro realizado com sucesso!\n\nSEU C√ìDIGO DE ACESSO √â: ' + data.codigo + '\n\nGuarde este n√∫mero para fazer login.');
                        window.location.href = "index.html";
                    } else {
                        alert('Erro: ' + data.message);
                    }
                })
                .catch(error => {
                    console.error('Erro!', error);
                    alert('Erro de conex√£o.');
                })
                .finally(() => {
                    botao.value = "Cadastrar";
                    botao.disabled = false;
                });
        });
    </script>
</body>

</html>